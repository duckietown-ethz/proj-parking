# Package `vehicle_detection` {#vehicle_detection}

<move-here src='#vehicle_detection-autogenerated'/>

In this package the formation keeping with circelgrids on the rear of Duckiebots is implemented.

## Start Nodes

The package is implemented in three nodes. Run the following commands on your Duckiebot:

The first node is the detector for circlegrids:

        $ roslaunch vehicle_detection vehicle_detection_node.launch veh:=![vehicle]
	
The second node estimates the pose between the following Duckiebot and a circlegrid:

        $ roslaunch vehicle_detection vehicle_filter_node.launch veh:=![vehicle]
        
The third node controlls the velocity of the following Duckiebot:

        $ roslaunch vehicle_detection vehicle_avoidance_control_node.launch veh:=![vehicle]
        
Where:

*`![vehicle]` is the name of the vehicle

## Test Nodes

For each node there is a test node. Run the following commands on your laptop:

To test the circlegrid detection:

        $ roslaunch vehicle_detection vehicle_detection_test_node.launch veh:=![vehicle]
        $ rqt_image_view
        
With `rqt_image_view` you can see the send image and the image with the detected pattern. In the terminal the pixel coordinates of each detected blob is displayed.

The output from `rqt_image_view` looks like [](#fig:circlegrid_detector_output).

<div figure-id="fig:circlegrid_detector_output" figure-caption="rqt_image_view output">
        <img src='rqt_image_view_output.png' style='width: 20em'/>
</div>

To test the pose estimation:

        $ roslaunch vehicle_detection vehicle_filter_test_node.launch veh:=![vehicle]
        
In the terminal the result of the pose estimation will be displayed.

To test the velocity controller:

        $ roslaunch vehicle_detection vehicle_avoidance_control_test_node.launch veh:=![vehicle]
        
In the terminal you see the velocity commands.
        

 


